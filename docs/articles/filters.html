<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filters • edeaR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Filters">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">edeaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/filters.html">Filters</a>
    </li>
    <li>
      <a href="../articles/metrics.html">Metrics</a>
    </li>
    <li>
      <a href="../articles/queue.html">Queue Analysis</a>
    </li>
    <li>
      <a href="../articles/work_schedules.html">Performance with work schedules</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bupaverse/edeaR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Filters</h1>
                        <h4 class="author">Gert Janssenswillen</h4>
            
            <h4 class="date">2020-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bupaverse/edeaR/blob/master/vignettes/filters.Rmd"><code>vignettes/filters.Rmd</code></a></small>
      <div class="hidden name"><code>filters.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bupaR)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'bupaR'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     filter</code></pre>
<pre><code>## The following object is masked from 'package:utils':
## 
##     timestamp</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(edeaR)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(eventdataR)</a></code></pre></div>
<p>The filters for event data subsetting can mostly be divided into two type: event filters and case filters. Event filters will subset <em>parts</em> of cases based on criteria applied on the events (e.g. the resource which performed it), while case filters will subset complete cases, based on criteria applied on the cases (e.g. the trace length).</p>
<p>Each filter has a <em>reverse</em> argument, which allows to reverse the filter very easily. Furthermore, each filter has an interface-alternative, which can be called by adding a <em>i</em> before the function name.</p>
<div id="event-filters" class="section level2">
<h2 class="hasAnchor">
<a href="#event-filters" class="anchor"></a>Event filters</h2>
<div id="filter-activities" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-activities" class="anchor"></a>Filter activities</h3>
<p>The filter activity function can be used to filter activities by name. It has three arguments</p>
<ul>
<li>the event log</li>
<li>a vector of activities</li>
<li>the reverse argument (FALSE or TRUE)</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">patients <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">    </span><span class="kw"><a href="../reference/filter_activity.html">filter_activity</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"X-Ray"</span>, <span class="st">"Blood test"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">    </span>summary</a></code></pre></div>
<pre><code>## Number of events:  996
## Number of cases:  498
## Number of traces:  2
## Number of distinct activities:  2
## Average trace length:  2
## 
## Start eventlog:  2017-01-05 08:59:04
## End eventlog:  2018-05-05 01:34:30</code></pre>
<pre><code>##                   handling     patient          employee handling_id       
##  Blood test           :474   Length:996         r1:  0   Length:996        
##  Check-out            :  0   Class :character   r2:  0   Class :character  
##  Discuss Results      :  0   Mode  :character   r3:474   Mode  :character  
##  MRI SCAN             :  0                      r4:  0                     
##  Registration         :  0                      r5:522                     
##  Triage and Assessment:  0                      r6:  0                     
##  X-Ray                :522                      r7:  0                     
##  registration_type      time                         .order     
##  complete:498      Min.   :2017-01-05 08:59:04   Min.   :  1.0  
##  start   :498      1st Qu.:2017-05-06 12:31:43   1st Qu.:249.8  
##                    Median :2017-09-08 00:10:11   Median :498.5  
##                    Mean   :2017-09-03 07:11:55   Mean   :498.5  
##                    3rd Qu.:2017-12-23 02:06:20   3rd Qu.:747.2  
##                    Max.   :2018-05-05 01:34:30   Max.   :996.0  
## </code></pre>
<p>As one can see, there are only 2 distinct activities left in the event log.</p>
</div>
<div id="filter-on-activity-frequency" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-on-activity-frequency" class="anchor"></a>Filter on activity frequency</h3>
<p>It is also possible to filter on activity frequency. This filter uses a percentile cut off, and will look at those activities which are most frequent until the required percentage of events has been reached. Thus, a percentile cut off of 80% will look at the activities needed to represent 80% of the events. In the example below, the <strong>least</strong> frequent activities covering 50% of the event log are selected, since the reverse argument is true.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">patients <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">    </span><span class="kw"><a href="../reference/filter_activity_frequency.html">filter_activity_frequency</a></span>(<span class="dt">percentile_cut_off =</span> <span class="fl">0.5</span>, <span class="dt">reverse =</span> T) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">    </span><span class="kw"><a href="../reference/activity_frequency.html">activity_frequency</a></span>(<span class="st">"activity"</span>)</a></code></pre></div>
<pre><code>## Warning in deprecated_perc(percentage, ...): Argument percentile_cut_off is
## deprecated. Use percentage instead.</code></pre>
<pre><code>## # A tibble: 4 x 3
##   handling   absolute relative
##   &lt;fct&gt;         &lt;int&gt;    &lt;dbl&gt;
## 1 Check-out       492    0.401
## 2 X-Ray           261    0.213
## 3 Blood test      237    0.193
## 4 MRI SCAN        236    0.192</code></pre>
</div>
<div id="filter-on-attributes" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-on-attributes" class="anchor"></a>Filter on attributes</h3>
<p>The filter_attributes function is a very generic function an can be supplied with conditions on the data set, in the same way as the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter</a></code> function. As such, it allows you to filter on event or case attributes. Multiple conditions can be listed, separated by a comma. In that case, the comma will be treated as “and”. You can use the |-symbol to state “OR”. Since the patients dataset does not have many additional attributes, the example below uses the resource and activity. This filter is thus the same as the combination of filter_activity and filter_resource, in case both conditions were required. However, it has the advantange of stating both conditions as OR.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">patients <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/bupaR/man/filter_attributes.html">filter_attributes</a></span>(employee <span class="op">==</span><span class="st"> "r1"</span> <span class="op">|</span><span class="st"> </span>handling <span class="op">==</span><span class="st"> "X-Ray"</span>) </a></code></pre></div>
<pre><code>## Log of 1522 events consisting of:
## 2 traces 
## 500 cases 
## 761 instances of 2 activities 
## 2 resources 
## Events occurred from 2017-01-02 11:41:53 until 2018-05-05 01:34:30 
##  
## Variables were mapped as follows:
## Case identifier:     patient 
## Activity identifier:     handling 
## Resource identifier:     employee 
## Activity instance identifier:    handling_id 
## Timestamp:           time 
## Lifecycle transition:        registration_type 
## 
## # A tibble: 1,522 x 7
##    handling patient employee handling_id registration_ty~ time               
##    &lt;fct&gt;    &lt;chr&gt;   &lt;fct&gt;    &lt;chr&gt;       &lt;fct&gt;            &lt;dttm&gt;             
##  1 Registr~ 1       r1       1           start            2017-01-02 11:41:53
##  2 Registr~ 2       r1       2           start            2017-01-02 11:41:53
##  3 Registr~ 3       r1       3           start            2017-01-04 01:34:05
##  4 Registr~ 4       r1       4           start            2017-01-04 01:34:04
##  5 Registr~ 5       r1       5           start            2017-01-04 16:07:47
##  6 Registr~ 6       r1       6           start            2017-01-04 16:07:47
##  7 Registr~ 7       r1       7           start            2017-01-05 04:56:11
##  8 Registr~ 8       r1       8           start            2017-01-05 04:56:11
##  9 Registr~ 9       r1       9           start            2017-01-06 05:58:54
## 10 Registr~ 10      r1       10          start            2017-01-06 05:58:54
## # ... with 1,512 more rows, and 1 more variable: .order &lt;int&gt;</code></pre>
</div>
<div id="filter-resources" class="section level3">
<h3 class="hasAnchor">
<a href="#filter-resources" class="anchor"></a>Filter resources</h3>
<p>Similar to the activity filter, the resource filter can be used to filter events by listing on or more resources.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">patients <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">    </span><span class="kw"><a href="../reference/filter_resource.html">filter_resource</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r1"</span>,<span class="st">"r4"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">    </span><span class="kw"><a href="../reference/resource_frequency.html">resource_frequency</a></span>(<span class="st">"resource"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   employee absolute relative
##   &lt;fct&gt;       &lt;int&gt;    &lt;dbl&gt;
## 1 r1            500    0.679
## 2 r4            236    0.321</code></pre>
</div>
<div id="trim-cases" class="section level3">
<h3 class="hasAnchor">
<a href="#trim-cases" class="anchor"></a>Trim cases</h3>
<p>The trim filter is a special event filter, as it also take into account the notion of cases. In fact, it <em>trim</em> cases such that they start with a certain activities until they end with a certain activity. It requires two list: one for possible start activities and one for end activities. The cases will be trimmed from the first appearance of a start activity till the last appearance of an end activity. When reversed, these <em>slices</em> of the event log will be removed instead of preserved.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">patients <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">    </span><span class="kw"><a href="../reference/filter_trim.html">filter_trim</a></span>(<span class="dt">start_activities =</span> <span class="st">"Registration"</span>, <span class="dt">end_activities =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MRI SCAN"</span>,<span class="st">"X-Ray"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/bupaR/man/traces.html">traces</a></span>()</a></code></pre></div>
<pre><code>## Warning: `tbl_df()` is deprecated as of dplyr 1.0.0.
## Please use `tibble::as_tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## # A tibble: 2 x 3
##   trace                                      absolute_frequen~ relative_frequen~
##   &lt;chr&gt;                                                  &lt;int&gt;             &lt;dbl&gt;
## 1 Registration,Triage and Assessment,X-Ray                 261             0.525
## 2 Registration,Triage and Assessment,Blood ~               236             0.475</code></pre>
</div>
</div>
<div id="case-filters" class="section level2">
<h2 class="hasAnchor">
<a href="#case-filters" class="anchor"></a>Case filters</h2>
<div id="filter-activity-presence" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-activity-presence" class="anchor"></a>Filter activity presence</h4>
<p>This functions allows to filter cases that contain certain activities. It requires as input a vector containing one or more activity labels and it has a <code>method</code> argument. The latter can have the values <em>all</em>, <em>none</em> or <em>one_of</em>. When set to <em>all</em>, it means that all the specified activity labels must be present for a case to be selected, <em>none</em> means that they are not allowed to be present, and <em>one_of</em> means that at least one of them must be present.</p>
</div>
<div id="filter-case" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-case" class="anchor"></a>Filter case</h4>
<p>The case filter allows to subset a set of case identifiers. As arguments it only requires a vector of case id’s. The selection can also be negated using <code>reverse = T</code>.</p>
</div>
<div id="filter-end-points" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-end-points" class="anchor"></a>Filter end points</h4>
<p>The <code>filter_endpoints</code> method filters cases based on the first and last activity label. It can be used in two ways: by specifying vectors with allowed start activities and/or allowed end activities, or by specifying a percentile. In the latter case, the percentile value will be used as a cut off. For example, when set to 0.9, it will select the most common endpoint pairs which together cover at least 90% of the cases, and filter the event log accordingly. This filter can also be reversed.</p>
</div>
<div id="filter-precedence" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-precedence" class="anchor"></a>Filter precedence</h4>
<p>In order to extract a subset of an event log which conforms with a set of precedence rules, one can use the <code>filter_precedence</code> method. There are two types of precendence relations which can be tested: activities that should <em>directly follow</em> each other, or activities that should <em>eventually follow</em> each other. The type can be set with the <em>precedence_type</em> argument. Further, the filter requires a vector of one or more antecedents (containing activity labels), and one or more consequents. Finally, also a <em>filter_method</em> argument can be set. This argument is relevant when there is more than one antecedent or consequent. In such a case, you can specify that all possible precedence combinations must be present (<em>all</em>), or at least one of them (_one_of).</p>
</div>
<div id="filter-processing-time-throughput-time-and-trace-length" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-processing-time-throughput-time-and-trace-length" class="anchor"></a>Filter processing time, throughput time and trace length</h4>
<p>There are three different filters which take into account the <em>length</em> of a case:</p>
<ul>
<li>processing time: which is the sum of the duration of the activity instances contained in the case.</li>
<li>throughput time: which is the time between the first event and the last event of the case.</li>
<li>trace length: which is the number of activity instances contained in the case.</li>
</ul>
<p>Each of these filters can work in two ways, similar to the endpoints filter: either by using an interval or by using a percentile cut off. The percentile cut off will always start with the shortest cases first and stop including cases when the specified percentile is reached. The processing and throughput time filters also have a <em>units</em> attribute to specify the time unit used when defining an interval. All the methods can be reversed by setting <code>reverse = T</code>.</p>
</div>
<div id="filter-time-period" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-time-period" class="anchor"></a>Filter time period</h4>
<p>Cases can also be filtered by supplying a time window to the method <code>filter_time_period</code>. There are four different filter methods, of which one can be used as argument:</p>
<ul>
<li>contained: retains all cases which are completely contained in the time period.</li>
<li>start: retains the cases which started in the time period, regardless of their end point.</li>
<li>complete: retains the cases which were completed in the time period, regardless of their starting point.</li>
<li>intersecting: retains the cases which have at least one event within the time period.</li>
</ul>
<p>The selection can also be reversed. Note that there is a 5 filter method, <em>trim</em>, but this is actually an event filter and will thus be discussed in the next section.</p>
</div>
<div id="filter-trace-frequency" class="section level4">
<h4 class="hasAnchor">
<a href="#filter-trace-frequency" class="anchor"></a>Filter trace frequency</h4>
<p>The last case filter can be used to filter cases based on the frequency of the corresponding trace. A trace is a sequence of activity labels, and will be discussed in more detail in Section . There are again two ways to select cases based on trace frequency, by interval or by percentile cut off. The percentile cut off will start with the most frequent traces. This filter also contains the reverse argument.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#event-filters">Event filters</a></li>
      <li><a href="#case-filters">Case filters</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gert Janssenswillen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
